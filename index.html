<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finan√ßas em Dia</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
--bg:#020617;
--card:#0f172a;
--border:#1e293b;
--text:#e5e7eb;
--muted:#94a3b8;
--gradient:linear-gradient(135deg,#22c55e,#38bdf8);
}
.light{
--bg:#f8fafc;
--card:#ffffff;
--border:#e2e8f0;
--text:#020617;
--muted:#475569;
}
*{box-sizing:border-box;font-family:Inter,sans-serif}
body{
margin:0;background:var(--bg);color:var(--text);
min-height:100vh;display:flex;justify-content:center;
padding:16px;
}
.app{width:100%;max-width:420px}
.hidden{display:none}

.logo{
text-align:center;font-size:28px;font-weight:800;
background:var(--gradient);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
margin-bottom:12px;
}

.card{
background:var(--card);
border:1px solid var(--border);
border-radius:18px;
padding:18px;
margin-bottom:14px;
}

label{font-size:12px;color:var(--muted)}
input,textarea,button{
width:100%;padding:12px;margin-top:6px;
border-radius:12px;border:1px solid var(--border);
background:transparent;color:var(--text);
}
textarea{resize:none}
button{
background:var(--gradient);
border:none;font-weight:700;color:#022c22;
}

.link{text-align:center;color:#38bdf8;cursor:pointer;margin-top:10px}

/* POPUP */
.overlay{
position:fixed;inset:0;
background:rgba(0,0,0,.6);
display:flex;align-items:center;justify-content:center;
z-index:10;
}
.popup{
background:var(--card);
border:1px solid var(--border);
border-radius:18px;
padding:18px;
width:92%;max-width:380px;
max-height:90vh;
overflow:auto;
}
</style>
</head>

<body>
<div class="app">

<div class="logo">FINAN√áAS EM DIA</div>

<!-- LOGIN -->
<div id="loginCard" class="card">
<label>Usu√°rio ou Email</label>
<input id="loginUser">
<label>Senha</label>
<input id="loginPass" type="password">
<button onclick="login()">Entrar</button>
<div class="link" onclick="showRegister()">Criar conta</div>
</div>

<!-- CADASTRO -->
<div id="registerCard" class="card hidden">
<label>Nome completo</label>
<input id="regName">
<label>Usu√°rio</label>
<input id="regUser">
<label>Email</label>
<input id="regEmail">
<label>Senha</label>
<input id="regPass" type="password">
<button onclick="register()">Cadastrar</button>
<div class="link" onclick="showLogin()">Voltar</div>
</div>

<!-- POPUP PRIMEIRO LOGIN -->
<div id="setupPopup" class="overlay hidden">
<div class="popup">
<h2>Personalizar App</h2>

<label>Nome da d√≠vida</label>
<input id="dName">

<label>Valor total</label>
<input id="dTotal" type="number">

<label>N¬∫ de parcelas</label>
<input id="dParc" type="number">

<label>Valor da parcela</label>
<input id="dParcValue" disabled>

<label>Prazo (meses)</label>
<input id="dPrazo" type="number">

<label>Data do vencimento</label>
<input id="dVenc" type="date">

<label>Observa√ß√µes</label>
<textarea id="dObs"></textarea>

<button onclick="saveInitialDebt()">Salvar d√≠vida</button>
<button onclick="finishSetup()">Concluir</button>
</div>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="hidden">
<div class="card">
<h2 id="welcome"></h2>
<canvas id="chart"></canvas>
</div>

<div class="card">
<h2>Assistente Financeiro ü§ñ</h2>
<input id="iaQuestion" placeholder="Ex: Vou conseguir pagar tudo?">
<button onclick="askIA()">Perguntar</button>
<div id="iaAnswer" style="margin-top:10px;color:var(--muted)"></div>
</div>
</div>

</div>

<script>
/* ================= CONFIG OPENAI ================= */
const OPENAI_API_KEY = "SUA_CHAVE_AQUI";

/* ================= STATE ================= */
let users = JSON.parse(localStorage.getItem("users")) || [];
let current = null;

/* ================= UI ================= */
function showRegister(){
loginCard.classList.add("hidden");
registerCard.classList.remove("hidden");
}
function showLogin(){
registerCard.classList.add("hidden");
loginCard.classList.remove("hidden");
}

/* ================= AUTH ================= */
function register(){
if(!regName.value||!regUser.value||!regEmail.value||!regPass.value)
return alert("Preencha tudo");

if(users.find(u=>u.user===regUser.value||u.email===regEmail.value))
return alert("Usu√°rio j√° existe");

users.push({
name:regName.value,
user:regUser.value,
email:regEmail.value,
pass:regPass.value,
firstLogin:true,
debts:[]
});
localStorage.setItem("users",JSON.stringify(users));
alert("Conta criada!");
showLogin();
}

function login(){
const u=users.find(u=>
(u.user===loginUser.value||u.email===loginUser.value)&&
u.pass===loginPass.value
);
if(!u)return alert("Login inv√°lido");

current=u;
loginCard.classList.add("hidden");
registerCard.classList.add("hidden");

if(u.firstLogin){
setupPopup.classList.remove("hidden");
}else{
openDashboard();
}
}

/* ================= SETUP ================= */
dParc.oninput=()=>{
dParcValue.value = dParc.value && dTotal.value
? (dTotal.value / dParc.value).toFixed(2)
: "";
};

function saveInitialDebt(){
if(!dName.value||!dTotal.value||!dParc.value) return;

current.debts.push({
name:dName.value,
total:+dTotal.value,
parcelas:+dParc.value,
parcela:+dParcValue.value,
prazo:+dPrazo.value,
vencimento:dVenc.value,
obs:dObs.value
});
localStorage.setItem("users",JSON.stringify(users));
alert("D√≠vida adicionada!");
}

function finishSetup(){
current.firstLogin=false;
localStorage.setItem("users",JSON.stringify(users));
setupPopup.classList.add("hidden");
openDashboard();
}

/* ================= DASH ================= */
function openDashboard(){
dashboard.classList.remove("hidden");
welcome.innerText=`Bem-vindo(a), ${current.name.split(" ")[0]}!`;
renderChart();
}

function renderChart(){
let total=0;
current.debts.forEach(d=>total+=d.total);
new Chart(chart,{
type:"doughnut",
data:{
labels:["D√≠vidas"],
datasets:[{data:[total],backgroundColor:["#22c55e"]}]
}
});
}

/* ================= IA OPENAI ================= */
async function askIA(){
iaAnswer.innerText="Analisando...";
let total=0;
current.debts.forEach(d=>total+=d.total);

const prompt=`
Usu√°rio possui R$ ${total} em d√≠vidas.
Detalhes: ${JSON.stringify(current.debts)}.
Pergunta: ${iaQuestion.value}
Responda como consultor financeiro, claro e direto.
`;

const res=await fetch("https://api.openai.com/v1/chat/completions",{
method:"POST",
headers:{
"Content-Type":"application/json",
"Authorization":"Bearer "+OPENAI_API_KEY
},
body:JSON.stringify({
model:"gpt-4o-mini",
messages:[{role:"user",content:prompt}],
temperature:0.4
})
});
const data=await res.json();
iaAnswer.innerText=data.choices?.[0]?.message?.content||"Erro ao responder";
}
</script>
</body>
</html>
