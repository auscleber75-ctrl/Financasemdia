<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finanças em Dia</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
--bg:#020617;
--card:#0f172a;
--border:#1e293b;
--text:#e5e7eb;
--muted:#94a3b8;
--gradient:linear-gradient(135deg,#22c55e,#38bdf8);
}
.light{
--bg:#f8fafc;
--card:#ffffff;
--border:#e2e8f0;
--text:#020617;
--muted:#475569;
}

*{box-sizing:border-box;font-family:Inter,sans-serif}

body{
margin:0;
background:var(--bg);
color:var(--text);
min-height:100vh;
}

.hidden{
display:none !important;
visibility:hidden !important;
opacity:0 !important;
pointer-events:none !important;
}

/* HEADER */
.header{
display:flex;
justify-content:space-between;
align-items:center;
padding:14px;
border-bottom:1px solid var(--border);
}
.logo{
font-weight:800;
background:var(--gradient);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}
.menu-btn{font-size:22px;cursor:pointer}

/* MENU */
.menu{
position:fixed;
top:0;left:0;
width:260px;
height:100%;
background:var(--card);
border-right:1px solid var(--border);
padding:16px;
transform:translateX(-100%);
transition:.3s;
z-index:20;
}
.menu.open{transform:translateX(0)}
.menu button{width:100%;margin-bottom:10px}

/* CARDS */
.card{
background:var(--card);
border:1px solid var(--border);
border-radius:16px;
padding:16px;
margin:16px;
}

input,button{
width:100%;
padding:12px;
margin-top:8px;
border-radius:12px;
border:1px solid var(--border);
background:transparent;
color:var(--text);
}
button{
background:var(--gradient);
border:none;
font-weight:700;
color:#022c22;
}

/* POPUP */
.overlay{
position:fixed;
inset:0;
background:rgba(0,0,0,.6);
display:flex;
align-items:center;
justify-content:center;
z-index:30;
}
.popup{
background:var(--card);
border-radius:18px;
padding:20px;
width:90%;
max-width:360px;
}
</style>
</head>

<body>

<!-- MENU -->
<div id="menu" class="menu hidden">
<button onclick="openSection('profile')">Perfil</button>
<button onclick="openSection('settings')">Configurações</button>
<button onclick="openSection('debts')">Gerir Dívidas</button>
<button onclick="logout()">Sair</button>
</div>

<!-- HEADER -->
<div id="header" class="header hidden">
<div class="menu-btn" onclick="toggleMenu()">☰</div>
<div class="logo">FINANÇAS EM DIA</div>
</div>

<!-- LOGIN -->
<div id="loginCard" class="card">
<input id="loginUser" placeholder="Usuário">
<input id="loginPass" type="password" placeholder="Senha">
<button onclick="login()">Entrar</button>
</div>

<!-- POPUP PRIMEIRO LOGIN -->
<div id="firstPopup" class="overlay hidden">
<div class="popup">
<h3>Bem-vindo!</h3>
<p>Vamos configurar seu app?</p>
<button onclick="closeFirstPopup()">Começar</button>
</div>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="hidden">
<div id="chartSection" class="card">
<h3>Resumo</h3>
<canvas id="chart"></canvas>
</div>
</div>

<!-- PERFIL -->
<div id="profile" class="hidden card">
<h3>Perfil</h3>
<input type="file">
<input id="profilePhone" placeholder="Telefone">
<input id="profilePass" type="password" placeholder="Nova senha">
<button onclick="saveProfile()">Salvar</button>
</div>

<!-- CONFIGURAÇÕES -->
<div id="settings" class="hidden card">
<h3>Configurações</h3>
<button onclick="toggleTheme()">Alternar tema</button>

<label>
<input type="checkbox" id="showCharts" checked onchange="saveSettings()">
 Mostrar gráficos
</label>

<label>
<input type="checkbox" id="showDebts" checked onchange="saveSettings()">
 Mostrar dívidas
</label>
</div>

<!-- DÍVIDAS -->
<div id="debts" class="hidden card">
<h3>Dívidas</h3>

<input id="dName" placeholder="Nome da dívida">
<input id="dValue" type="number" placeholder="Valor total">
<button onclick="addDebt()">Adicionar</button>

<div id="debtList"></div>
</div>

<script>
/* ===== STATE ===== */
let users = JSON.parse(localStorage.getItem("users")) || [
  {user:"teste",pass:"123",firstLogin:true,debts:[],settings:{}}
];
let currentUser=null;
let isAuthenticated=false;

/* ===== INIT ===== */
function initApp(){
  header.classList.add("hidden");
  menu.classList.add("hidden");
  firstPopup.classList.add("hidden");
  dashboard.classList.add("hidden");
  profile.classList.add("hidden");
  settings.classList.add("hidden");
  debts.classList.add("hidden");

  loginCard.classList.remove("hidden");

  isAuthenticated=false;
  currentUser=null;
}
initApp();

/* ===== AUTH ===== */
function login(){
  const u=users.find(u=>u.user===loginUser.value && u.pass===loginPass.value);
  if(!u)return alert("Login inválido");

  currentUser=u;
  isAuthenticated=true;

  loginCard.classList.add("hidden");
  header.classList.remove("hidden");
  menu.classList.remove("hidden");

  applySettings();

  if(u.firstLogin){
    firstPopup.classList.remove("hidden");
  }else{
    openDashboard();
  }
}

function closeFirstPopup(){
  currentUser.firstLogin=false;
  saveUsers();
  firstPopup.classList.add("hidden");
  openDashboard();
}

function logout(){
  initApp();
}

/* ===== UI ===== */
function toggleMenu(){
  if(!isAuthenticated)return;
  menu.classList.toggle("open");
}

function openSection(id){
  dashboard.classList.add("hidden");
  profile.classList.add("hidden");
  settings.classList.add("hidden");
  debts.classList.add("hidden");

  document.getElementById(id).classList.remove("hidden");
  menu.classList.remove("open");
}

function openDashboard(){
  dashboard.classList.remove("hidden");
  renderChart();
}

/* ===== PROFILE ===== */
function saveProfile(){
  if(profilePass.value)currentUser.pass=profilePass.value;
  currentUser.phone=profilePhone.value;
  saveUsers();
  alert("Perfil atualizado");
}

/* ===== SETTINGS ===== */
function saveSettings(){
  currentUser.settings={
    showCharts:showCharts.checked,
    showDebts:showDebts.checked
  };
  saveUsers();
  applySettings();
}

function applySettings(){
  const s=currentUser.settings||{};
  chartSection.style.display=s.showCharts===false?"none":"block";
  debts.style.display=s.showDebts===false?"none":"block";
}

function toggleTheme(){
  document.body.classList.toggle("light");
}

/* ===== DÍVIDAS ===== */
function addDebt(){
  if(!dName.value||!dValue.value)return;
  currentUser.debts.push({name:dName.value,value:+dValue.value});
  dName.value="";dValue.value="";
  saveUsers();
  renderDebts();
}

function renderDebts(){
  debtList.innerHTML="";
  currentUser.debts.forEach((d,i)=>{
    debtList.innerHTML+=`
      <div style="margin-top:8px">
        ${d.name} - R$ ${d.value.toFixed(2)}
        <button onclick="removeDebt(${i})">X</button>
      </div>`;
  });
}

function removeDebt(i){
  currentUser.debts.splice(i,1);
  saveUsers();
  renderDebts();
}

/* ===== CHART ===== */
function renderChart(){
  if(!currentUser.debts)return;
  let total=0;
  currentUser.debts.forEach(d=>total+=d.value);

  new Chart(chart,{
    type:"doughnut",
    data:{
      labels:["Total em dívidas"],
      datasets:[{data:[total]}]
    }
  });
}

/* ===== STORAGE ===== */
function saveUsers(){
  localStorage.setItem("users",JSON.stringify(users));
}
</script>
</body>
</html>
